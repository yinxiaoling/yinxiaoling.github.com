(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{198:function(t,s,e){"use strict";e.r(s);var a=e(0),n=Object(a.a)({},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),e("p",[e("code",[t._v("etcd")]),t._v(" 目前在 "),e("a",{attrs:{href:"https://github.com/coreos/etcd",target:"_blank",rel:"noopener noreferrer"}},[t._v("github.com/coreos/etcd"),e("OutboundLink")],1),t._v(" 进行维护。")]),t._v(" "),e("p",[t._v("受到 "),e("a",{attrs:{href:"https://zookeeper.apache.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Apache ZooKeeper"),e("OutboundLink")],1),t._v(" 项目和 "),e("a",{attrs:{href:"https://github.com/ha/doozerd",target:"_blank",rel:"noopener noreferrer"}},[t._v("doozer"),e("OutboundLink")],1),t._v(" 项目的启发，"),e("code",[t._v("etcd")]),t._v(" 在设计的时候重点考虑了下面四个要素：")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("简单：具有定义良好、面向用户的 "),e("code",[t._v("API")]),t._v(" ("),e("a",{attrs:{href:"https://github.com/grpc/grpc",target:"_blank",rel:"noopener noreferrer"}},[t._v("gRPC"),e("OutboundLink")],1),t._v(")")])]),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7)]),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),e("p",[e("em",[e("a",{attrs:{href:"https://raft.github.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Raft"),e("OutboundLink")],1),t._v(" 是一套通过选举主节点来实现分布式系统一致性的算法，相比于大名鼎鼎的 Paxos 算法，它的过程更容易被人理解，由 Stanford 大学的 Diego Ongaro 和 John Ousterhout 提出。更多细节可以参考 "),e("a",{attrs:{href:"http://raftconsensus.github.io",target:"_blank",rel:"noopener noreferrer"}},[t._v("raftconsensus.github.io"),e("OutboundLink")],1),t._v("。")])]),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),e("p",[e("code",[t._v("etcd")]),t._v(" 基于 "),e("code",[t._v("Go")]),t._v(" 语言实现，因此，用户可以从 "),e("a",{attrs:{href:"https://github.com/coreos/etcd",target:"_blank",rel:"noopener noreferrer"}},[t._v("项目主页"),e("OutboundLink")],1),t._v(" 下载源代码自行编译，也可以下载编译好的二进制文件，甚至直接使用制作好的 "),e("code",[t._v("Docker")]),t._v(" 镜像文件来体验。")]),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),e("p",[t._v("编译好的二进制文件都在 "),e("a",{attrs:{href:"https://github.com/coreos/etcd/releases/",target:"_blank",rel:"noopener noreferrer"}},[t._v("github.com/coreos/etcd/releases"),e("OutboundLink")],1),t._v(" 页面，用户可以选择需要的版本，或通过下载工具下载。")]),t._v(" "),t._m(14),t._v(" "),t._m(15),e("p",[t._v("解压后，可以看到文件包括")]),t._v(" "),t._m(16),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._m(20),t._v(" "),t._m(21),t._m(22),t._v(" "),t._m(23),e("p",[t._v("说明 etcd 服务已经成功启动了。")]),t._v(" "),t._m(24),t._v(" "),t._m(25),t._v(" "),t._m(26),t._m(27),t._v(" "),t._m(28),t._v(" "),t._m(29),t._v(" "),t._m(30),t._m(31),t._v(" "),t._m(32),t._v(" "),t._m(33),t._v(" "),t._m(34),t._m(35),t._v(" "),t._m(36),t._m(37),t._v(" "),t._m(38),t._v(" "),e("p",[e("code",[t._v("etcd")]),t._v(" 项目二进制发行包中已经包含了 "),e("code",[t._v("etcdctl")]),t._v(" 工具，没有的话，可以从 "),e("a",{attrs:{href:"https://github.com/coreos/etcd/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("github.com/coreos/etcd/releases"),e("OutboundLink")],1),t._v(" 下载。")]),t._v(" "),t._m(39),t._v(" "),t._m(40),t._m(41),t._v(" "),e("p",[t._v("数据库操作围绕对键值和目录的 CRUD （符合 REST 风格的一套操作：Create）完整生命周期的管理。")]),t._v(" "),t._m(42),t._v(" "),t._m(43),t._v(" "),t._m(44),t._v(" "),t._m(45),t._m(46),t._v(" "),e("p",[t._v("获取指定键的值。例如")]),t._v(" "),t._m(47),e("p",[t._v("支持的选项为")]),t._v(" "),t._m(48),t._v(" "),t._m(49),t._v(" "),t._m(50),t._v(" "),e("p",[t._v("删除某个键值。例如")]),t._v(" "),t._m(51),t._m(52),t._v(" "),t._m(53),t._v(" "),e("p",[t._v("监测一个键值的变化，一旦键值发生更新，就会输出最新的值。")]),t._v(" "),t._m(54),t._v(" "),t._m(55),t._m(56),t._v(" "),t._m(57),t._v(" "),t._m(58),t._v(" "),t._m(59)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"etcd-项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#etcd-项目","aria-hidden":"true"}},[this._v("#")]),this._v(" Etcd 项目")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("p",[e("code",[t._v("etcd")]),t._v(" 是 "),e("code",[t._v("CoreOS")]),t._v(" 团队发起的一个管理配置信息和服务发现（"),e("code",[t._v("Service Discovery")]),t._v("）的项目，在这一章里面，我们将基于 "),e("code",[t._v("etcd 3.x")]),t._v(" 版本介绍该项目的目标，安装和使用，以及实现的技术。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"什么是-etcd"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#什么是-etcd","aria-hidden":"true"}},[this._v("#")]),this._v(" 什么是 etcd")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"https://yeasy.gitbooks.io/docker_practice/etcd/_images/etcd_logo.png",alt:"img"}})])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("p",[e("code",[t._v("etcd")]),t._v(" 是 "),e("code",[t._v("CoreOS")]),t._v(" 团队于 2013 年 6 月发起的开源项目，它的目标是构建一个高可用的分布式键值（"),e("code",[t._v("key-value")]),t._v("）数据库，基于 "),e("code",[t._v("Go")]),t._v(" 语言实现。我们知道，在分布式系统中，各种服务的配置信息的管理分享，服务的发现是一个很基本同时也是很重要的问题。"),e("code",[t._v("CoreOS")]),t._v(" 项目就希望基于 "),e("code",[t._v("etcd")]),t._v(" 来解决这一问题。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("p",[this._v("安全：支持 "),s("code",[this._v("HTTPS")]),this._v(" 方式的访问")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("p",[this._v("快速：支持并发 "),s("code",[this._v("10 k/s")]),this._v(" 的写操作")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("p",[this._v("可靠：支持分布式结构，基于 "),s("code",[this._v("Raft")]),this._v(" 的一致性算法")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("em",[this._v("Apache ZooKeeper 是一套知名的分布式系统中进行同步和一致性管理的工具。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("em",[this._v("doozer 是一个一致性分布式数据库。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("一般情况下，用户使用 "),s("code",[this._v("etcd")]),this._v(" 可以在多个节点上启动多个实例，并添加它们为一个集群。同一个集群中的 "),s("code",[this._v("etcd")]),this._v(" 实例将会保持彼此信息的一致性。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装","aria-hidden":"true"}},[this._v("#")]),this._v(" 安装")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("注意：本章节内容基于 etcd "),s("code",[this._v("3.x")]),this._v(" 版本")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"二进制文件方式下载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二进制文件方式下载","aria-hidden":"true"}},[this._v("#")]),this._v(" 二进制文件方式下载")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("例如，使用 "),s("code",[this._v("curl")]),this._v(" 工具下载压缩包，并解压。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[this._v("curl")]),this._v(" -L  https://github.com/coreos/etcd/releases/download/v3.2.10/etcd-v3.2.10-linux-amd64.tar.gz -o etcd-v3.2.10-linux-amd64.tar.gz\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[this._v("tar")]),this._v(" xzvf etcd-v3.2.10-linux-amd64.tar.gz\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[this._v("cd")]),this._v(" etcd-v3.2.10-linux-amd64\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[this._v("ls")]),this._v("\nDocumentation README-etcdctl.md README.md READMEv2-etcdctl.md etcd etcdctl\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("其中 "),s("code",[this._v("etcd")]),this._v(" 是服务主文件，"),s("code",[this._v("etcdctl")]),this._v(" 是提供给用户的命令客户端，其他文件是支持文档。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("下面将 "),s("code",[this._v("etcd")]),this._v(" "),s("code",[this._v("etcdctl")]),this._v(" 文件放到系统可执行目录（例如 "),s("code",[this._v("/usr/local/bin/")]),this._v("）。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[this._v("cp")]),this._v(" etcd* /usr/local/bin/\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("默认 "),s("code",[this._v("2379")]),this._v(" 端口处理客户端的请求，"),s("code",[this._v("2380")]),this._v(" 端口用于集群各成员间的通信。启动 "),s("code",[this._v("etcd")]),this._v(" 显示类似如下的信息：")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ etcd\n2017-12-03 11:18:34.406082 I "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" etcdmain: etcd Version: 3.2.10\n2017-12-03 11:18:34.406226 I "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" etcdmain: Git SHA: GitNotFound\n2017-12-03 11:18:34.406235 I "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" etcdmain: Go Version: go1.9.2\n2017-12-03 11:18:34.406242 I "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" etcdmain: Go OS/Arch: darwin/amd64\n2017-12-03 11:18:34.406250 I "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" etcdmain: setting maximum number of CPUs to 4, total number of available CPUs is 4\n2017-12-03 11:18:34.406265 N "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" etcdmain: failed to detect default host "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("default host not supported on darwin_amd64"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n2017-12-03 11:18:34.406279 W "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" etcdmain: no data-dir provided, using default data-dir ./default.etcd\n2017-12-03 11:18:34.406457 N "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" etcdmain: the server is already initialized as member before, starting as etcd member"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n2017-12-03 11:18:34.411579 I "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" embed: listening "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" peers on http://localhost:2380\n2017-12-03 11:18:34.411938 I "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" embed: listening "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" client requests on localhost:2379\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("此时，可以使用 "),s("code",[this._v("etcdctl")]),this._v(" 命令进行测试，设置和获取键值 "),s("code",[this._v('testkey: "hello world"')]),this._v("，检查 "),s("code",[this._v("etcd")]),this._v(" 服务是否启动成功：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("$ ETCDCTL_API"),s("span",{pre:!0,attrs:{class:"token operator"}},[this._v("=")]),this._v("3 etcdctl member list\n8e9e05c52164694d, started, default, http://localhost:2380, http://localhost:2379\n\n$ ETCDCTL_API"),s("span",{pre:!0,attrs:{class:"token operator"}},[this._v("=")]),this._v("3 etcdctl put testkey "),s("span",{pre:!0,attrs:{class:"token string"}},[this._v('"hello world"')]),this._v("\nOK\n\n$ etcdctl get testkey\ntestkey\nhello world\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"docker-镜像方式运行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker-镜像方式运行","aria-hidden":"true"}},[this._v("#")]),this._v(" Docker 镜像方式运行")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("p",[t._v("镜像名称为 "),e("code",[t._v("quay.io/coreos/etcd")]),t._v("，可以通过下面的命令启动 "),e("code",[t._v("etcd")]),t._v(" 服务监听到 "),e("code",[t._v("2379")]),t._v(" 和 "),e("code",[t._v("2380")]),t._v(" 端口。")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("export")]),t._v(" NODE1"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("192.168.1.21\n\n$ docker run --name etcd \\\n    -p 2379:2379 \\\n    -p 2380:2380 \\\n    --volume"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("etcd-data:/etcd-data \\\n    quay.io/coreos/etcd:latest \\\n    /usr/local/bin/etcd \\\n    --data-dir"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/etcd-data --name node1 \\\n    --initial-advertise-peer-urls http://"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${NODE1}")]),t._v(":2380 --listen-peer-urls http://0.0.0.0:2380 \\\n    --advertise-client-urls http://"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${NODE1}")]),t._v(":2379 --listen-client-urls http://0.0.0.0:2379 \\\n    --initial-cluster node1"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("http://"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${NODE1}")]),t._v(":2380\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("注意：etcd 官方标注 "),s("code",[this._v("quay.io/coreos/etcd")]),this._v(" 即将废弃，启用新的 "),s("code",[this._v("gcr.io/etcd-development/etcd")]),this._v(" 镜像，但后者由于网络原因，国内不能下载到该镜像，这里仍然使用前者作为演示。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("打开新的终端按照上一步的方法测试 "),s("code",[this._v("etcd")]),this._v(" 是否成功启动。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"macos-中运行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#macos-中运行","aria-hidden":"true"}},[this._v("#")]),this._v(" macOS 中运行")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("$ brew "),s("span",{pre:!0,attrs:{class:"token function"}},[this._v("install")]),this._v(" etcd\n\n$ etcd\n\n$ etcdctl member list\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"etcd-集群"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#etcd-集群","aria-hidden":"true"}},[this._v("#")]),this._v(" etcd 集群")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("下面我们使用 Docker Compose 模拟启动一个 3 节点的 "),s("code",[this._v("etcd")]),this._v(" 集群。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("编辑 "),s("code",[this._v("docker-compose.yml")]),this._v(" 文件")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3.6"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("node1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" quay.io/coreos/etcd\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" node1"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/etcd"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("data\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("expose")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2379")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2380      ")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("cluster_net")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ipv4_address")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 172.16.238.100\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ETCDCTL_API=3\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /usr/local/bin/etcd\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("dir=/etcd"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("data\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("name\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" node1\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("initial"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("advertise"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("peer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("urls\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//172.16.238.100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2380")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("listen"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("peer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("urls\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//0.0.0.0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2380")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("advertise"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("client"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("urls\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//172.16.238.100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2379")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("listen"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("client"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("urls\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//0.0.0.0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2379")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("initial"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("cluster\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" node1=http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//172.16.238.100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2380")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("node2=http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//172.16.238.101"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2380")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("node3=http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//172.16.238.102"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2380")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("initial"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("cluster"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("state\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" new\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("initial"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("cluster"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("token\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" docker"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("etcd\n\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("node2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" quay.io/coreos/etcd\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" node2"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/etcd"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("data\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("cluster_net")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ipv4_address")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 172.16.238.101\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ETCDCTL_API=3\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("expose")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2379")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2380")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /usr/local/bin/etcd\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("dir=/etcd"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("data\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("name\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" node2\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("initial"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("advertise"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("peer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("urls\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//172.16.238.101"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2380")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("listen"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("peer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("urls\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//0.0.0.0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2380")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("advertise"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("client"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("urls\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//172.16.238.101"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2379")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("listen"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("client"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("urls\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//0.0.0.0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2379")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("initial"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("cluster\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" node1=http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//172.16.238.100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2380")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("node2=http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//172.16.238.101"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2380")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("node3=http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//172.16.238.102"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2380")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("initial"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("cluster"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("state\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" new\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("initial"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("cluster"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("token\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" docker"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("etcd\n\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("node3")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" quay.io/coreos/etcd\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" node3"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/etcd"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("data\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("cluster_net")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ipv4_address")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 172.16.238.102\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ETCDCTL_API=3\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("expose")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2379")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2380")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("command")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" /usr/local/bin/etcd\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("data"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("dir=/etcd"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("data\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("name\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" node3\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("initial"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("advertise"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("peer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("urls\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//172.16.238.102"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2380")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("listen"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("peer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("urls\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//0.0.0.0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2380")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("advertise"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("client"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("urls\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//172.16.238.102"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2379")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("listen"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("client"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("urls\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//0.0.0.0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2379")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("initial"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("cluster\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" node1=http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//172.16.238.100"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2380")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("node2=http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//172.16.238.101"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2380")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("node3=http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//172.16.238.102"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2380")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("initial"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("cluster"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("state\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" new\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("initial"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("cluster"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("token\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" docker"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("etcd\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("node1-data")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("node2-data")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("node3-data")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("cluster_net")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("driver")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" bridge\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ipam")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("driver")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" default\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("config")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("subnet")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 172.16.238.0/24\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("使用 "),s("code",[this._v("docker-compose up")]),this._v(" 启动集群之后使用 "),s("code",[this._v("docker exec")]),this._v(" 命令登录到任一节点测试 "),s("code",[this._v("etcd")]),this._v(" 集群。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("/ "),s("span",{pre:!0,attrs:{class:"token comment"}},[this._v("# etcdctl member list")]),this._v("\ndaf3fd52e3583ff, started, node3, http://172.16.238.102:2380, http://172.16.238.102:2379\n422a74f03b622fef, started, node1, http://172.16.238.100:2380, http://172.16.238.100:2379\ned635d2a2dbef43d, started, node2, http://172.16.238.101:2380, http://172.16.238.101:2379\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"使用-etcdctl"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-etcdctl","aria-hidden":"true"}},[this._v("#")]),this._v(" 使用 etcdctl")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("p",[e("code",[t._v("etcdctl")]),t._v(" 是一个命令行客户端，它能提供一些简洁的命令，供用户直接跟 "),e("code",[t._v("etcd")]),t._v(" 服务打交道，而无需基于 "),e("code",[t._v("HTTP API")]),t._v(" 方式。这在某些情况下将很方便，例如用户对服务进行测试或者手动修改数据库内容。我们也推荐在刚接触 "),e("code",[t._v("etcd")]),t._v(" 时通过 "),e("code",[t._v("etcdctl")]),t._v(" 命令来熟悉相关的操作，这些操作跟 "),e("code",[t._v("HTTP API")]),t._v(" 实际上是对应的。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("etcdctl")]),this._v(" 支持如下的命令，大体上分为数据库操作和非数据库操作两类，后面将分别进行解释。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v('NAME:\n\tetcdctl - A simple command line client for etcd3.\n\nUSAGE:\n\tetcdctl\n\nVERSION:\n\t3.2.10\n\nAPI VERSION:\n\t3.2\n\n\nCOMMANDS:\n\tget\t\t\tGets the key or a range of keys\n\tput\t\t\tPuts the given key into the store\n\tdel\t\t\tRemoves the specified key or range of keys [key, range_end)\n\ttxn\t\t\tTxn processes all the requests in one transaction\n\tcompaction\t\tCompacts the event history in etcd\n\talarm disarm\t\tDisarms all alarms\n\talarm list\t\tLists all alarms\n\tdefrag\t\t\tDefragments the storage of the etcd members with given endpoints\n\tendpoint health\t\tChecks the healthiness of endpoints specified in `--endpoints` flag\n\tendpoint status\t\tPrints out the status of endpoints specified in `--endpoints` flag\n\twatch\t\t\tWatches events stream on keys or prefixes\n\tversion\t\t\tPrints the version of etcdctl\n\tlease grant\t\tCreates leases\n\tlease revoke\t\tRevokes leases\n\tlease timetolive\tGet lease information\n\tlease keep-alive\tKeeps leases alive (renew)\n\tmember add\t\tAdds a member into the cluster\n\tmember remove\t\tRemoves a member from the cluster\n\tmember update\t\tUpdates a member in the cluster\n\tmember list\t\tLists all members in the cluster\n\tsnapshot save\t\tStores an etcd node backend snapshot to a given file\n\tsnapshot restore\tRestores an etcd member snapshot to an etcd directory\n\tsnapshot status\t\tGets backend snapshot status of a given file\n\tmake-mirror\t\tMakes a mirror at the destination etcd cluster\n\tmigrate\t\t\tMigrates keys in a v2 store to a mvcc store\n\tlock\t\t\tAcquires a named lock\n\telect\t\t\tObserves and participates in leader election\n\tauth enable\t\tEnables authentication\n\tauth disable\t\tDisables authentication\n\tuser add\t\tAdds a new user\n\tuser delete\t\tDeletes a user\n\tuser get\t\tGets detailed information of a user\n\tuser list\t\tLists all users\n\tuser passwd\t\tChanges password of user\n\tuser grant-role\t\tGrants a role to a user\n\tuser revoke-role\tRevokes a role from a user\n\trole add\t\tAdds a new role\n\trole delete\t\tDeletes a role\n\trole get\t\tGets detailed information of a role\n\trole list\t\tLists all roles\n\trole grant-permission\tGrants a key to a role\n\trole revoke-permission\tRevokes a key from a role\n\tcheck perf\t\tCheck the performance of the etcd cluster\n\thelp\t\t\tHelp about any command\n\nOPTIONS:\n      --cacert=""\t\t\t\tverify certificates of TLS-enabled secure servers using this CA bundle\n      --cert=""\t\t\t\t\tidentify secure client using this TLS certificate file\n      --command-timeout=5s\t\t\ttimeout for short running command (excluding dial timeout)\n      --debug[=false]\t\t\t\tenable client-side debug logging\n      --dial-timeout=2s\t\t\t\tdial timeout for client connections\n      --endpoints=[127.0.0.1:2379]\t\tgRPC endpoints\n      --hex[=false]\t\t\t\tprint byte strings as hex encoded strings\n      --insecure-skip-tls-verify[=false]\tskip server certificate verification\n      --insecure-transport[=true]\t\tdisable transport security for client connections\n      --key=""\t\t\t\t\tidentify secure client using this TLS key file\n      --user=""\t\t\t\t\tusername[:password] for authentication (prompt if password is not supplied)\n  -w, --write-out="simple"\t\t\tset the output format (fields, json, protobuf, simple, table)\n')])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"数据库操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#数据库操作","aria-hidden":"true"}},[this._v("#")]),this._v(" 数据库操作")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("etcd 在键的组织上采用了层次化的空间结构（类似于文件系统中目录的概念），用户指定的键可以为单独的名字，如 "),s("code",[this._v("testkey")]),this._v("，此时实际上放在根目录 "),s("code",[this._v("/")]),this._v(" 下面，也可以为指定目录结构，如 "),s("code",[this._v("cluster1/node2/testkey")]),this._v("，则将创建相应的目录结构。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("注：CRUD 即 Create, Read, Update, Delete，是符合 REST 风格的一套 API 操作。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"put"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#put","aria-hidden":"true"}},[this._v("#")]),this._v(" put")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("$ etcdctl put /testdir/testkey "),s("span",{pre:!0,attrs:{class:"token string"}},[this._v('"Hello world"')]),this._v("\nOK\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"get"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get","aria-hidden":"true"}},[this._v("#")]),this._v(" get")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("$ etcdctl put testkey hello\nOK\n$ etcdctl get testkey\ntestkey\nhello\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("--sort")]),this._v("\t对结果进行排序")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("--consistent")]),this._v(" 将请求发给主节点，保证获取内容的一致性")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"del"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#del","aria-hidden":"true"}},[this._v("#")]),this._v(" del")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("$ etcdctl del testkey\n1\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"非数据库操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#非数据库操作","aria-hidden":"true"}},[this._v("#")]),this._v(" 非数据库操作")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"watch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#watch","aria-hidden":"true"}},[this._v("#")]),this._v(" watch")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("例如，用户更新 "),s("code",[this._v("testkey")]),this._v(" 键值为 "),s("code",[this._v("Hello world")]),this._v("。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("$ etcdctl "),s("span",{pre:!0,attrs:{class:"token function"}},[this._v("watch")]),this._v(" testkey\nPUT\ntestkey\n2\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"member"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#member","aria-hidden":"true"}},[this._v("#")]),this._v(" member")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("p",[t._v("通过 "),e("code",[t._v("list")]),t._v("、"),e("code",[t._v("add")]),t._v("、"),e("code",[t._v("update")]),t._v("、"),e("code",[t._v("remove")]),t._v(" 命令列出、添加、更新、删除 etcd 实例到 etcd 集群中。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("例如本地启动一个 "),s("code",[this._v("etcd")]),this._v(" 服务实例后，可以用如下命令进行查看。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("$ etcdctl member list\n422a74f03b622fef, started, node1, http://172.16.238.100:2380, http://172.16.238.100:23\n")])])])}],!1,null,null,null);n.options.__file="etcd.md";s.default=n.exports}}]);