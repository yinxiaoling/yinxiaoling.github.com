(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{200:function(e,t,s){"use strict";s.r(t);var r=s(0),a=Object(r.a)({},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"content"},[e._m(0),e._v(" "),e._m(1),e._v(" "),s("p",[e._v("Docker Machine 是 Docker 官方编排（Orchestration）项目之一，负责在多种平台上快速安装 Docker 环境。")]),e._v(" "),s("p",[e._v("Docker Machine 项目基于 Go 语言实现，目前在 "),s("a",{attrs:{href:"https://github.com/docker/machine",target:"_blank",rel:"noopener noreferrer"}},[e._v("Github"),s("OutboundLink")],1),e._v(" 上进行维护。")]),e._v(" "),s("p",[e._v("本章将介绍 Docker Machine 的安装及使用。")]),e._v(" "),e._m(2),e._v(" "),s("p",[e._v("Docker Machine 可以在多种操作系统平台上安装，包括 Linux、macOS，以及 Windows。")]),e._v(" "),e._m(3),e._v(" "),e._m(4),e._v(" "),s("p",[e._v("查看版本信息。")]),e._v(" "),e._m(5),e._m(6),e._v(" "),s("p",[e._v("在 Linux 上的也安装十分简单，从 "),s("a",{attrs:{href:"https://github.com/docker/machine/releases",target:"_blank",rel:"noopener noreferrer"}},[e._v("官方 GitHub Release"),s("OutboundLink")],1),e._v(" 处直接下载编译好的二进制文件即可。")]),e._v(" "),s("p",[e._v("例如，在 Linux 64 位系统上直接下载对应的二进制包。")]),e._v(" "),e._m(7),s("p",[e._v("完成后，查看版本信息。")]),e._v(" "),e._m(8),e._m(9),e._v(" "),s("p",[e._v("Docker Machine 支持多种后端驱动，包括虚拟机、本地主机和云平台等。")]),e._v(" "),e._m(10),e._v(" "),e._m(11),e._v(" "),e._m(12),e._v(" "),e._m(13),s("p",[e._v("你也可以在创建时加上如下参数，来配置主机或者主机上的 Docker。")]),e._v(" "),e._m(14),e._v(" "),e._m(15),e._v(" "),e._m(16),e._v(" "),e._m(17),e._v(" "),e._m(18),e._v(" "),e._m(19),e._v(" "),s("p",[s("code",[e._v("xhyve")]),e._v(" 驱动 GitHub: "),s("a",{attrs:{href:"https://github.com/zchee/docker-machine-driver-xhyve",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/zchee/docker-machine-driver-xhyve"),s("OutboundLink")],1)]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/mist64/xhyve",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("xhyve")]),s("OutboundLink")],1),e._v(" 是 macOS 上轻量化的虚拟引擎，使用其创建的 Docker Machine 较 "),s("code",[e._v("VirtualBox")]),e._v(" 驱动创建的运行效率要高。")]),e._v(" "),e._m(20),e._m(21),e._v(" "),e._m(22),e._v(" "),e._m(23),e._v(" "),e._m(24),e._v(" "),e._m(25),e._v(" "),e._m(26),e._m(27),e._v(" "),e._m(28),e._v(" "),s("p",[e._v("创建好主机之后，查看主机")]),e._v(" "),e._m(29),e._m(30),e._v(" "),e._m(31),s("p",[e._v("后续根据提示在命令行输入命令之后就可以操作 test 主机。")]),e._v(" "),e._m(32),e._v(" "),e._m(33),s("p",[e._v("连接到主机之后你就可以在其上使用 Docker 了。")]),e._v(" "),e._m(34),e._v(" "),e._m(35),e._v(" "),e._m(36),e._v(" "),e._m(37),e._v(" "),s("p",[e._v("请到 "),s("a",{attrs:{href:"https://github.com/docker/docker.github.io/blob/master/machine/AVAILABLE_DRIVER_PLUGINS.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("第三方驱动列表"),s("OutboundLink")],1),e._v(" 查看")]),e._v(" "),e._m(38),e._v(" "),e._m(39),e._v(" "),s("p",[e._v("每个命令，又带有不同的参数，可以通过")]),e._v(" "),e._m(40),s("p",[e._v("来查看具体的用法。")])])},[function(){var e=this.$createElement,t=this._self._c||e;return t("h1",{attrs:{id:"docker-三剑客之-docker-machine"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-三剑客之-docker-machine","aria-hidden":"true"}},[this._v("#")]),this._v(" Docker 三剑客之 Docker Machine")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("img",{attrs:{src:"https://docs.docker.com/machine/img/machine.png",alt:"img"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装","aria-hidden":"true"}},[this._v("#")]),this._v(" 安装")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"macos、windows"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#macos、windows","aria-hidden":"true"}},[this._v("#")]),this._v(" macOS、Windows")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Docker for Mac、Docker for Windows 自带 "),t("code",[this._v("docker-machine")]),this._v(" 二进制包，安装之后即可使用。")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("$ docker-machine -v\ndocker-machine version 0.13.0, build 9ba6da9\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"linux"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux","aria-hidden":"true"}},[this._v("#")]),this._v(" Linux")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -L https://github.com/docker/machine/releases/download/v0.13.0/docker-machine-"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("`")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("uname")]),e._v(" -s"),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("`")])]),e._v("-"),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("`")]),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("uname")]),e._v(" -m"),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("`")])]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" /usr/local/bin/docker-machine\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("chmod")]),e._v(" +x /usr/local/bin/docker-machine\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("$ docker-machine -v\ndocker-machine version 0.13.0, build 9ba6da9\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用","aria-hidden":"true"}},[this._v("#")]),this._v(" 使用")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"创建本地主机实例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建本地主机实例","aria-hidden":"true"}},[this._v("#")]),this._v(" 创建本地主机实例")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h4",{attrs:{id:"virtualbox-驱动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#virtualbox-驱动","aria-hidden":"true"}},[this._v("#")]),this._v(" Virtualbox 驱动")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("使用 "),t("code",[this._v("virtualbox")]),this._v(" 类型的驱动，创建一台 Docker 主机，命名为 test。")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("$ docker-machine create -d virtualbox "),t("span",{pre:!0,attrs:{class:"token function"}},[this._v("test")]),this._v("\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("code",[this._v("--engine-opt dns=114.114.114.114")]),this._v(" 配置 Docker 的默认 DNS")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("code",[this._v("--engine-registry-mirror https://registry.docker-cn.com")]),this._v(" 配置 Docker 的仓库镜像")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("code",[this._v("--virtualbox-memory 2048")]),this._v(" 配置主机内存")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("code",[this._v("--virtualbox-cpu-count 2")]),this._v(" 配置主机 CPU")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("更多参数请使用 "),t("code",[this._v("docker-machine create --driver virtualbox --help")]),this._v(" 命令查看。")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h4",{attrs:{id:"macos-xhyve-驱动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#macos-xhyve-驱动","aria-hidden":"true"}},[this._v("#")]),this._v(" macOS xhyve 驱动")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("$ brew "),t("span",{pre:!0,attrs:{class:"token function"}},[this._v("install")]),this._v(" docker-machine-driver-xhyve\n\n$ docker-machine create \\\n      -d xhyve \\\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[this._v("# --xhyve-boot2docker-url ~/.docker/machine/cache/boot2docker.iso \\")]),this._v("\n      --engine-opt dns"),t("span",{pre:!0,attrs:{class:"token operator"}},[this._v("=")]),this._v("114.114.114.114 \\\n      --engine-registry-mirror https://registry.docker-cn.com \\\n      --xhyve-memory-size 2048 \\\n      --xhyve-rawdisk \\\n      --xhyve-cpu-count 2 \\\n      xhyve\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("blockquote",[t("p",[this._v("注意：非首次创建时建议加上 "),t("code",[this._v("--xhyve-boot2docker-url ~/.docker/machine/cache/boot2docker.iso")]),this._v(" 参数，避免每次创建时都从 GitHub 下载 ISO 镜像。")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("更多参数请使用 "),t("code",[this._v("docker-machine create --driver xhyve --help")]),this._v(" 命令查看。")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h4",{attrs:{id:"windows-10"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#windows-10","aria-hidden":"true"}},[this._v("#")]),this._v(" Windows 10")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Windows 10 安装 Docker for Windows 之后不能再安装 VirtualBox，也就不能使用 "),t("code",[this._v("virtualbox")]),this._v(" 驱动来创建 Docker Machine，我们可以选择使用 "),t("code",[this._v("hyperv")]),this._v(" 驱动。")])},function(){var e=this.$createElement,t=this._self._c||e;return t("blockquote",[t("p",[this._v("注意，必须事先在 "),t("code",[this._v("Hyper-V")]),this._v(" 管理器中新建一个 "),t("strong",[this._v("外部虚拟交换机")]),this._v(" 执行下面的命令时，使用 "),t("code",[this._v("--hyperv-virtual-switch=MY_SWITCH")]),this._v(" 指定虚拟交换机名称")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("$ docker-machine create --driver hyperv --hyperv-virtual-switch"),t("span",{pre:!0,attrs:{class:"token operator"}},[this._v("=")]),this._v("MY_SWITCH vm\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("更多参数请使用 "),t("code",[this._v("docker-machine create --driver hyperv --help")]),this._v(" 命令查看。")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"使用介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用介绍","aria-hidden":"true"}},[this._v("#")]),this._v(" 使用介绍")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("$ docker-machine "),t("span",{pre:!0,attrs:{class:"token function"}},[this._v("ls")]),this._v("\n\nNAME      ACTIVE   DRIVER       STATE     URL                         SWARM   DOCKER       ERRORS\n"),t("span",{pre:!0,attrs:{class:"token function"}},[this._v("test")]),this._v("      -        virtualbox   Running   tcp://192.168.99.187:2376           v17.10.0-ce\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("创建主机成功后，可以通过 "),t("code",[this._v("env")]),this._v(" 命令来让后续操作对象都是目标主机。")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("$ docker-machine "),t("span",{pre:!0,attrs:{class:"token function"}},[this._v("env")]),this._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[this._v("test")]),this._v("\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("也可以通过 "),t("code",[this._v("SSH")]),this._v(" 登录到主机。")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("$ docker-machine "),t("span",{pre:!0,attrs:{class:"token function"}},[this._v("ssh")]),this._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[this._v("test")]),this._v("\n\ndocker@test:~$ docker --version\nDocker version 17.10.0-ce, build f4ffd25\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"官方支持驱动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#官方支持驱动","aria-hidden":"true"}},[this._v("#")]),this._v(" 官方支持驱动")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("通过 "),t("code",[this._v("-d")]),this._v(" 选项可以选择支持的驱动类型。")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ul",[s("li",[e._v("amazonec2")]),e._v(" "),s("li",[e._v("azure")]),e._v(" "),s("li",[e._v("digitalocean")]),e._v(" "),s("li",[e._v("exoscale")]),e._v(" "),s("li",[e._v("generic")]),e._v(" "),s("li",[e._v("google")]),e._v(" "),s("li",[e._v("hyperv")]),e._v(" "),s("li",[e._v("none")]),e._v(" "),s("li",[e._v("openstack")]),e._v(" "),s("li",[e._v("rackspace")]),e._v(" "),s("li",[e._v("softlayer")]),e._v(" "),s("li",[e._v("virtualbox")]),e._v(" "),s("li",[e._v("vmwarevcloudair")]),e._v(" "),s("li",[e._v("vmwarefusion")]),e._v(" "),s("li",[e._v("vmwarevsphere")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"第三方驱动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第三方驱动","aria-hidden":"true"}},[this._v("#")]),this._v(" 第三方驱动")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"操作命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#操作命令","aria-hidden":"true"}},[this._v("#")]),this._v(" 操作命令")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ul",[s("li",[s("code",[e._v("active")]),e._v(" 查看活跃的 Docker 主机")]),e._v(" "),s("li",[s("code",[e._v("config")]),e._v(" 输出连接的配置信息")]),e._v(" "),s("li",[s("code",[e._v("create")]),e._v(" 创建一个 Docker 主机")]),e._v(" "),s("li",[s("code",[e._v("env")]),e._v(" 显示连接到某个主机需要的环境变量")]),e._v(" "),s("li",[s("code",[e._v("inspect")]),e._v(" 输出主机更多信息")]),e._v(" "),s("li",[s("code",[e._v("ip")]),e._v(" 获取主机地址")]),e._v(" "),s("li",[s("code",[e._v("kill")]),e._v(" 停止某个主机")]),e._v(" "),s("li",[s("code",[e._v("ls")]),e._v(" 列出所有管理的主机")]),e._v(" "),s("li",[s("code",[e._v("provision")]),e._v(" 重新设置一个已存在的主机")]),e._v(" "),s("li",[s("code",[e._v("regenerate-certs")]),e._v(" 为某个主机重新生成 TLS 认证信息")]),e._v(" "),s("li",[s("code",[e._v("restart")]),e._v(" 重启主机")]),e._v(" "),s("li",[s("code",[e._v("rm")]),e._v(" 删除某台主机")]),e._v(" "),s("li",[s("code",[e._v("ssh")]),e._v(" SSH 到主机上执行命令")]),e._v(" "),s("li",[s("code",[e._v("scp")]),e._v(" 在主机之间复制文件")]),e._v(" "),s("li",[s("code",[e._v("mount")]),e._v(" 挂载主机目录到本地")]),e._v(" "),s("li",[s("code",[e._v("start")]),e._v(" 启动一个主机")]),e._v(" "),s("li",[s("code",[e._v("status")]),e._v(" 查看主机状态")]),e._v(" "),s("li",[s("code",[e._v("stop")]),e._v(" 停止一个主机")]),e._v(" "),s("li",[s("code",[e._v("upgrade")]),e._v(" 更新主机 Docker 版本为最新")]),e._v(" "),s("li",[s("code",[e._v("url")]),e._v(" 获取主机的 URL")]),e._v(" "),s("li",[s("code",[e._v("version")]),e._v(" 输出 docker-machine 版本信息")]),e._v(" "),s("li",[s("code",[e._v("help")]),e._v(" 输出帮助信息")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("$ docker-machine COMMAND --help\n")])])])}],!1,null,null,null);a.options.__file="machine.md";t.default=a.exports}}]);